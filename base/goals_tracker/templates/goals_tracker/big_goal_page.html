{% extends "goals_tracker/layout.html" %} {% block title %} Home - Goal
Tracker{%endblock %} {% block body %}

<main class="py-5" id="big-goal-page">
  {% comment %} Top {% endcomment %}
   <section>
      <div class="d-flex justify-content-between">
        <div class="d-flex align-items-center">
          <h1 class="fw-normal">{{ big_goal.title }}</h1>
        </div>

        <!-- Daily System Modal -->
        <div id="daily-system-modal" class="modal">
          <div class="modal-center">
            <div
              class="daily-system-modal-content"
              id="daily-system-modal-content"
            >
              {% comment %} Header {% endcomment %}
              <h3 class="fw-light mb-5">
                What would you do <span class="fst-italic fw-normal"> daily</span> to make it a reality?
              </h3>

              <span id="daily-system-message" class="text-danger fs-5 fw-light"></span>
  
              {% comment %} Body {% endcomment %}
              <form id="daily-system-form">
                {% csrf_token %}
                <div class="mb-5">
                  <input
                    autofocus
                    class="form-control p-4 fs-4 bg-body-tertiary box-radius"
                    type="text"
                    id="daily-system-title"
                    name="daily-system-title"
                    required
                  />
                </div>
  
                <div class="d-flex justify-content-end gap-4">
                  <button
                    type="button"
                    id="close-daily-system-modal"
                    class="p-4 border-0 bg-transparent fs-4 box-radius"
                  >
                    Close
                  </button>
                  <button
                    type="submit"
                    class="p-4 border-0 bg-success-subtle fs-4 box-radius"
                  >
                    Create Daily System
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        {% comment %} Header {% endcomment %}
        <div class="d-flex column-gap-3">
          <div class="d-flex justify-content-end mb-4">
            <button
              class="border bg-transparent p-3 fs-5 box-radius"
              id="open-daily-system-modal"
            >
              <i class="bi bi-plus-lg"></i> Add a Daily Action
            </button>
          </div>

          <div>
            <button id="delete-now-btn" class="delete-now-btn box-radius">Delete now</button>
          </div>
        </div>
      </div>

      <div>
        {% if big_goal.description %}
          <p class="fs-4">{{big_goal.description}}</p>
        {% endif %}
        <span class="align-self-end">ends in {{ timeline.deadline }}</span>
      </div>
   </section>

    {% comment %} Timeline - Body {% endcomment %}
    <section class="big-goal-section box-radius">
        <input type="hidden" id="no-edit-title-hidden" value="{{title_unedited}}" />
        <input type="hidden" id="title-hidden" value="{{big_goal.title}}" />
        <input type="hidden" id="description-hidden" value="{{big_goal.description}}" />
        <input type="hidden" id="start-hidden" value="{{timeline.start}}" />
        <input type="hidden" id="deadline-hidden" value="{{timeline.deadline}}" />
        <input type="hidden" id="bg-daily-systems" value="{{actions}}" />

        {% comment %} Timeline {% endcomment %}
        <div class="mt-5">
          <div id="month-year"></div>
          <div class="timeline" id="timeline">
            {% for date in timeline.all_dates %}
            <div class="timeline-item" data-date={{date.current}}>
              <div class="timeline-item--head">
                <span class="m-0">{{ date.current|slice:":3" }}</span>
                <span class="timeline-item--head-day">{{ date.current|slice:"8:10" }}</span>
              </div>
              <div class="timeline-item--body">
                {% for system in daily_systems %}
                  <div class="bg-dark-subtle box-radius daily-system-box" data-big-goal={{system.big_goal}}>
                    {% if system.action in date.actions %}
                      <p class="fs-5 m-0 text-decoration-line-through"> {{ system.action }} </p>
                    {% else %}
                      <p class="fs-5 m-0"> {{ system.action }} </p>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
    </section>

    <section class="checkpoint-goals-section box-radius mt-4">
      <div class="d-flex justify-content-between mb-4">
        <h2 class="fw-normal">Checkpoint Goals</h2>
        <button
          class="border bg-transparent py-2 px-3 fs-5 rounded-circle"
          id="open-checkpoint-goal-modal"
        >
          <i class="bi bi-plus-lg"></i>
        </button>
      </div>

      <!-- Checkpoint Goal Modal -->
      <div id="checkpoint-goal-modal" class="modal">
        <div class="modal-center">
          <div
            class="checkpoint-goal-modal-content"
            id="checkpoint-goal-modal-content"
          >
            {% comment %} Header {% endcomment %}
            <h3 class="fw-normal mb-5">Create your Checkpoint Goal</h3>

            {% comment %} Body {% endcomment %}
            <form id="checkpoint-goal-form">
              {% csrf_token %}
              
              <div class="d-flex mb-5 gap-4 modal-flex-direction">
                <div class="flex-grow-1">
                  <label for="checkpoint-goal-title" class="form-label fs-4">Title</label>
                  <input autofocus class="form-control p-4 fs-4 bg-body-tertiary box-radius" type="text"
                    id="checkpoint-goal-title" name="checkpoint-goal-title" required />
                </div>
                <div class="">
                  <label for="checkpoint-goal-date" class="form-label fs-4">Date</label>
                  <input class="form-control p-4 fs-4 bg-body-tertiary box-radius" type="date" id="checkpoint-goal-date"
                    name="checkpoint-goal-date" required />
                </div>
              </div>

              <div class="mb-5">
                <label for="checkpoint-goal-description" class="form-label fs-4">Description
                  <span class="optional-field">(optional)</span>
                </label>
                <textarea class="form-control p-4 fs-4 bg-body-tertiary box-radius" id="checkpoint-goal-description"
                  name="checkpoint-goal-description" placeholder=""></textarea>
              </div>

              <div class="d-flex justify-content-end gap-4">
                <button
                  type="button"
                  id="close-checkpoint-goal-modal"
                  class="p-4 border-0 bg-transparent fs-4 box-radius"
                >
                  Close
                </button>
                <button
                  type="submit"
                  class="p-4 border-0 bg-success-subtle fs-4 box-radius"
                >
                  Create Checkpoint Goal
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="d-flex flex-wrap gap-3">
      {% for cp_goal in checkpoint_goals %}
        <div class="box-radius checkpoint-goal-box">
          <p class="m-0 fs-5">{{ cp_goal.title }}</p>
          <p class="m-0 fs-5">{{ cp_goal.description }}</p>
          <p class="m-0 fs-5">{{ cp_goal.date }}</p>
        </div>
        {% empty %}
        <div>No Checkpoint Goals. Create One Now.</div>
      {% endfor %}
      </div>
    </section>

    <section class="anti-goals-section box-radius mt-4">
      <div class="d-flex justify-content-between mb-4">
        <h2 class="fw-normal">Anti Goals</h2>
        <button
          class="border bg-transparent py-2 px-3 fs-5 rounded-circle"
          id="open-anti-goal-modal"
        >
          <i class="bi bi-plus-lg"></i>
        </button>
      </div>

      <!-- Anti Goal Modal -->
      <div id="anti-goal-modal" class="modal">
        <div class="modal-center">
          <div
            class="anti-goal-modal-content"
            id="anti-goal-modal-content"
          >
            {% comment %} Header {% endcomment %}
            <h3 class="fw-light mb-5">
              What would you <span class="fst-italic fw-normal">not allow to happen</span> as you work towards your Big Goal?
            </h3>

            {% comment %} Body {% endcomment %}
            <form id="anti-goal-form">
              {% csrf_token %}
              <div class="mb-5">
                <textarea class="form-control p-4 fs-4 bg-body-tertiary box-radius" id="anti-goal-description"
                  name="anti-goal-description" required></textarea>
              </div>

              <div class="d-flex justify-content-end gap-4">
                <button
                  type="button"
                  id="close-anti-goal-modal"
                  class="p-4 border-0 bg-transparent fs-4 box-radius"
                >
                  Close
                </button>
                <button
                  type="submit"
                  class="p-4 border-0 bg-success-subtle fs-4 box-radius"
                >
                  Create Anti Goal
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="d-flex flex-wrap gap-3">
        {% for xgoal in anti_goals %}
        <div class="box-radius anti-goal-box">
          <p class="m-0 fs-5">{{ xgoal.description }}</p>
        </div>
        {% empty %}
        <div>No Anti Goals. Create One Now.</div>
        {% endfor %}
      </div>
    </section>

</main>

{% endblock %}
